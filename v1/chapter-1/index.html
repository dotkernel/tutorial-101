<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="description" content="Beginner tutorial for using Dotkernel">
        
        

        
        
            
        
        <meta name="docsearch:version" content="1.0.0,latest">
        <meta name="docsearch:language" content="en">
        <meta name="docsearch:component" content="Dotkernel 101">

        
        <link rel="canonical" href="https://docs.dotkernel.org/tutorial-101/v1/chapter-1/">
        
        <link rel="shortcut icon" href="https://docs.dotkernel.org/img/dk_docs_favicon_white.svg">

        <title>1. Installing Doctrine - Dotkernel 101 - Dotkernel Documentation</title>

        <link rel="stylesheet" href="https://docs.dotkernel.org/css/bootstrap.css">
        <link rel="stylesheet" href="https://docs.dotkernel.org/css/bootstrap-icons.min.css">
        <link rel="stylesheet" href="https://docs.dotkernel.org/css/docs.css">
        <script src="https://docs.dotkernel.org/js/bootstrap.js" defer></script>
        <script src="https://docs.dotkernel.org/js/docs.js" defer></script>
        <script src="https://docs.dotkernel.org/js/scripts.js" defer></script>
    </head>
    <body data-bs-spy="scroll" data-bs-target=".toc" data-bs-offset="100">

        
        <nav class="navbar navbar-expand-lg bg-body-tertiary bg-light dk-nav py-3" data-bs-theme="light">
    <div class="container justify-content-between">
        <div class="dk-nav-icon d-flex align-items-center">
            <a class="navbar-brand" href="https://docs.dotkernel.org/">
                <img alt="Dotkernel Logo" class="d-inline-block align-text-top" height="50"
                     src="https://docs.dotkernel.org//img/dk_logomark_white.svg" width="45"/>
            </a>

            <div class="dk-nav-icon-items">
                <span style="font-size: 12px; line-height: 13px">Dotkernel Documentation</span>

                <div class="dropdown" data-bs-theme="light">
                    <span class="fw-bold dropdown-toggle dk-pkg-name" data-bs-toggle="dropdown" aria-expanded="false">Tutorial-101</span>
                    <ul class="dropdown-menu">
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/api-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <i class="bi bi-arrow-return-right text-primary"></i>
                                <div class="py-1">
                                    <span class="fw-bold d-block">API</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/admin-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <i class="bi bi-arrow-return-right text-primary"></i>
                                <div class="py-1">
                                    <span class="fw-bold d-block">Admin</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/frontend-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <i class="bi bi-arrow-return-right text-primary"></i>
                                <div class="py-1">
                                    <span class="fw-bold d-block">Frontend</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/light-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <i class="bi bi-arrow-return-right text-primary"></i>
                                <div class="py-1">
                                    <span class="fw-bold d-block">Light</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/queue-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <i class="bi bi-arrow-return-right text-primary"></i>
                                <div class="py-1">
                                    <span class="fw-bold d-block">Queue</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/packages/" class="nav-link d-flex gap-4 align-items-center">
                                <i class="bi bi-arrow-return-right text-primary"></i>
                                <div class="py-1">
                                    <span class="fw-bold d-block">Packages</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/development/" class="nav-link d-flex gap-4 align-items-center">
                                <i class="bi bi-arrow-return-right text-primary"></i>
                                <div class="py-1">
                                    <span class="fw-bold d-block">Development</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/headless-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <i class="bi bi-arrow-return-right text-primary"></i>
                                <div class="py-1">
                                    <span class="fw-bold d-block">Headless Platform</span>
                                </div>
                            </a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
<!--                <li class="nav-item">-->
<!--                    <a href="#" class="nav-link fw-bold text-white" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal" title="Open search">-->
<!--                        <i class="bi bi-search"></i> Search-->
<!--                    </a>-->
<!--                </li>-->
                <li class="nav-item">
                    <a class="nav-link fw-bold text-white" href="https://github.com/dotkernel/tutorial-101" title="Go to Dotkernel 101 repository" target="_blank">
                        <i class="bi bi-github"></i>
                        GitHub
                    </a>
                </li>
                <li class="nav-item">
                    
    

                </li>
            </ul>
        </div>
    </div>
</nav>

        
        <div class="container">
    <nav aria-label="breadcrumb" class="nav_breadcrumb">
        <ol class="breadcrumb">
            
                <li class="breadcrumb-item"><a href="https://docs.dotkernel.org/">Overview</a></li>
                

                
                    <li class="breadcrumb-item"><a href="../..">Dotkernel 101</a></li>

                    
                        
                            
                            
                                <li class="breadcrumb-item">Tutorial</li>
                            
                        
                    

                    <li class="breadcrumb-item active" aria-current="page">1. Installing Doctrine</li>
                
            
        </ol>
    </nav>
</div>

        
        <div class="container">
            <div class="row">
                <div class="col-lg-3 right_sidebar">
                    
                    
    <div class="subnavigation hidden-print">
<!--        <h4 class="subnavigation__title">-->
<!--            <a href="../..">Dotkernel 101</a>-->
<!--        </h4>-->

        <h5 class="subnavigation__title">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Tutorial</span>
                                <ul class="subnavigation__list">
                                    
                                        
<li class="subnavigation__list-item ">
    <a href="../introduction/" class="subnavigation__link">Introduction</a>
</li>

                                    
                                        
<li class="subnavigation__list-item subnavigation__list-item--active">
    <a href="./" class="subnavigation__link">1. Installing Doctrine</a>
</li>

                                    
                                        
<li class="subnavigation__list-item ">
    <a href="../chapter-2/" class="subnavigation__link">2. Entities and Migrations</a>
</li>

                                    
                                        
<li class="subnavigation__list-item ">
    <a href="../chapter-3/" class="subnavigation__link">3. Fixtures and Custom Listing</a>
</li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                    

                    
                    
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
            
                <li class="toc__entry">
                    <a href="#composer-requirements" class="toc__link nav-link">Composer Requirements</a>
                </li>
            
                <li class="toc__entry">
                    <a href="#setting-up-doctrine" class="toc__link nav-link">Setting Up Doctrine</a>
                </li>
            
                <li class="toc__entry">
                    <a href="#running-doctrine" class="toc__link nav-link">Running doctrine</a>
                </li>
            
            </ul>
        </div>
    

                    
                </div>
                <div class="col-lg-9 main_docs">
                    
                    




    
    
<!--        <h2 class="chapter__headline text-black-50">Tutorial</h2>-->
    

    <h1 id="installing-doctrine">Installing Doctrine</h1>
<h2 id="composer-requirements">Composer Requirements</h2>
<p>The first step is to add alongside your current packages the required entries for our Doctrine installation.
We would add the following to our <code>composer.json</code> file located in our root folder:</p>
<p><img alt="composer.json" src="../images/chapter-1/composer.png" class="img-responsive"/></p>
<pre class="highlight"><code class="language-text">"dotkernel/dot-cache": "^4.0",
"ramsey/uuid": "^4.5.0",
"ramsey/uuid-doctrine": "^2.1.0",
"roave/psr-container-doctrine": "^5.2.2 || ^6.0.0",</code></pre>
<p><code>dotkernel/dot-cache</code></p>
<p>Provides caching support for Dotkernel applications.
It offers a PSR-6 and PSR-16 compatible caching system that integrates smoothly with Dotkernel's service container.</p>
<p><code>ramsey/uuid</code></p>
<p>A widely used PHP library for generating and working with UUIDs (Universally Unique Identifiers).
It supports multiple UUID versions.</p>
<p><code>ramsey/uuid-doctrine</code></p>
<p>Adds UUID support to Doctrine ORM using ramsey/uuid.
It allows Doctrine to store and retrieve UUIDs as proper value objects instead of plain strings, improving type safety.</p>
<p><code>roave/psr-container-doctrine</code></p>
<p>Provides a set of factory classes that integrate Doctrine ORM with any PSR-11 container.
It simplifies wiring Doctrine EntityManager, DBAL, configuration, and related services in frameworks like Dotkernel.</p>
<p><code>phpstan/phpstan-doctrine (dev requirement)</code></p>
<p>An extension for PHPStan that improves static analysis for Doctrine.
It understands entity metadata, repositories, and common Doctrine patterns, helping catch errors during development.</p>
<h3 id="update-composer-dependencies">Update Composer Dependencies</h3>
<p>Run the following command to install the new required packages:</p>
<pre class="highlight"><code class="language-shell">composer update</code></pre>
<p>The command should be run whenever we change anything in our <code>composer.json</code> file.</p>
<h2 id="setting-up-doctrine">Setting Up Doctrine</h2>
<p>After successfully installing our dependencies, we now need to configure our Doctrine instance.</p>
<h3 id="declare-your-database">Declare your database</h3>
<p>In the file <code>config/autoload/local.php</code> the structure would be updated like this:</p>
<p><img alt="local.php" src="../images/chapter-1/local.png" class="img-responsive"/></p>
<pre class="highlight"><code class="language-php">$databases = [
    'default' =&gt; [
        'host'     =&gt; 'localhost',
        'dbname'   =&gt; 'light',
        'user'     =&gt; 'root',
        'password' =&gt; '123',
        'port'     =&gt; 3306,
        'driver'   =&gt; 'pdo_mysql',
        'charset'  =&gt; 'utf8mb4',
        'collate'  =&gt; 'utf8mb4_general_ci',
    ],
    // you can add more database connections into this array
];

return [
    'databases'   =&gt; $databases,
    'doctrine'    =&gt; [
        'connection' =&gt; [
            'orm_default' =&gt; [
                'params' =&gt; $databases['default'],
            ],
        ],
    ],
    // the rest of your configuration
];</code></pre>
<h3 id="declare-the-doctrine-drivers">Declare the Doctrine Drivers</h3>
<p>With the very nice utility of the package <code>laminas/laminas-config-aggregator</code> we can declare our doctrine settings in the <code>src/App/src/ConfigProvider.php</code> file.
This package takes all the provided configs from the <code>config/config.php</code> file and merges them into one.</p>
<p>Our new <code>src/App/src/ConfigProvider.php</code> class would look like this now:</p>
<p><img alt="config-provider-1" src="../images/chapter-1/config-provider-1.png" class="img-responsive"/></p>
<p><img alt="config-provider-2" src="../images/chapter-1/config-provider-2.png" class="img-responsive"/></p>
<pre class="highlight"><code class="language-php">public function __invoke(): array
{
    return [
        'dependencies' =&gt; $this-&gt;getDependencies(),
        'doctrine'     =&gt; $this-&gt;getDoctrineConfig(),
        'templates'    =&gt; $this-&gt;getTemplates(),
    ];
}

public function getDependencies(): array
{
    return [
        'delegators' =&gt; [
            Application::class =&gt; [
                RoutesDelegator::class,
            ],
        ],
        'factories'  =&gt; [
            'doctrine.entity_manager.orm_default' =&gt; EntityManagerFactory::class,
            GetIndexViewHandler::class            =&gt; GetIndexViewHandlerFactory::class,
        ],
        'aliases'    =&gt; [
            EntityManager::class          =&gt; 'doctrine.entity_manager.orm_default',
            EntityManagerInterface::class =&gt; 'doctrine.entity_manager.orm_default',
        ],
    ];
}

private function getDoctrineConfig(): array
{
    return [
        'cache'         =&gt; [
            'array'      =&gt; [
                'class' =&gt; ArrayAdapter::class,
            ],
            'filesystem' =&gt; [
                'class'     =&gt; FilesystemAdapter::class,
                'directory' =&gt; getcwd() . '/data/cache',
                'namespace' =&gt; 'doctrine',
            ],
        ],
        'configuration' =&gt; [
            'orm_default' =&gt; [
                'result_cache'       =&gt; 'filesystem',
                'metadata_cache'     =&gt; 'filesystem',
                'query_cache'        =&gt; 'filesystem',
                'hydration_cache'    =&gt; 'array',
                'typed_field_mapper' =&gt; null,
                'second_level_cache' =&gt; [
                    'enabled'                    =&gt; true,
                    'default_lifetime'           =&gt; 3600,
                    'default_lock_lifetime'      =&gt; 60,
                    'file_lock_region_directory' =&gt; '',
                    'regions'                    =&gt; [],
                ],
            ],
        ],
        'driver'        =&gt; [
            // The default metadata driver aggregates all other drivers into a single one.
            // Override `orm_default` only if you know what you're doing.
            'orm_default' =&gt; [
                'class' =&gt; MappingDriverChain::class,
            ],
        ],
        'types'         =&gt; [
            UuidType::NAME =&gt; UuidType::class,
        ],
    ];
}</code></pre>
<h2 id="running-doctrine">Running doctrine</h2>
<p>Now that everything has been configured we only need to do one last thing, to create an executable for the Doctrine CLI.
In our case we will create a <code>doctrine</code> file inside the application's <code>bin</code> directory:</p>
<pre class="highlight"><code class="language-php">#!/usr/bin/env php
&lt;?php

declare(strict_types=1);

use Doctrine\ORM\EntityManager;
use Doctrine\ORM\Tools\Console\ConsoleRunner;
use Doctrine\ORM\Tools\Console\EntityManagerProvider\SingleManagerProvider;

require_once 'vendor/autoload.php';

$container = require 'config/container.php';

$entityManager = $container-&gt;get(EntityManager::class);
$entityManager-&gt;getEventManager();

ConsoleRunner::run(new SingleManagerProvider($entityManager));</code></pre>
<p>Now by running the command bellow we should see the Doctrine CLI version alongside its available commands:</p>
<pre class="highlight"><code class="language-shell">php ./bin/doctrine</code></pre>
<p>Example (truncated) output:</p>
<pre class="highlight"><code class="language-terminaloutput">Doctrine Command Line Interface 3.5.7.0

Options:
  -h, --help            Display help for the given command. When no command is given display help for the list command
      --silent          Do not output any message
  -q, --quiet           Only errors are displayed. All other output is suppressed
  -V, --version         Display this application version
      --ansi|--no-ansi  Force (or disable --no-ansi) ANSI output
  -n, --no-interaction  Do not ask any interactive question
  -v|vv|vvv, --verbose  Increase the verbosity of messages: 1 for normal output, 2 for more verbose output and 3 for debug</code></pre>
<h3 id="summary">Summary</h3>
<ul>
<li>[Modified] composer.json</li>
<li>[Modified] config/autoload/local.php</li>
<li>[Modified] src/App/src/ConfigProvider.php</li>
<li>[+] bin/doctrine</li>
</ul>




    <nav>
    <ul class="list-unstyled page-nav row w-100 mt-5 mb-3 pt-5 pb-3">
        
        <li class="col text-nowrap text-md-start">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../introduction/">
                    <i class="bi bi-chevron-left"></i>
                    Introduction
                </a>
            
        </li>

        
        <li class="col text-nowrap text-md-end pe-0">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../chapter-2/">
                    2. Entities and Migrations
                    <i class="bi bi-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



                    
                </div>
            </div>
        </div>

        
        <footer class="footer">
    <div class="container">
        <hr class="mb-5" />

        <div class="row">
            <div class="col-md-9">
                <div class="row">
                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">API</p>

                        <a href="https://docs.dotkernel.org/api-documentation/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel web starter project suitable for building RESTful APIs
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Admin</p>

                        <a href="https://docs.dotkernel.org/admin-documentation/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel web starter project suitable for admin applications
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Frontend</p>

                        <a href="https://docs.dotkernel.org/frontend-documentation/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel web starter project suitable for frontend applications
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Light</p>

                        <a href="https://docs.dotkernel.org/light-documentation/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel web starter project suitable for generating a simple website
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Dotkernel Packages</p>

                        <a href="https://docs.dotkernel.org/packages/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel packages offering a wide range of tools
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Development environment</p>

                        <a href="https://docs.dotkernel.org/development/">
                            <i class="bi bi-arrow-return-right"></i>
                            Install PHP, Apache, MariaDB, Composer, PhpMyAdmin, Node.js and Git on WSL2
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-md-3 pt-3 mt-1">
                <ul class="support__list row">
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://github.com/dotkernel" class="support__link" title="GitHub" target="_blank">
                            <i class="bi bi-github"></i> GitHub
                        </a>
                    </li>
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://dotkernel.slack.com" class="support__link" title="Chat" target="_blank">
                            <i class="bi bi-slack"></i> Slack
                        </a>
                    </li>
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://twitter.com/dotkernel" class="support__link" title="X (Twitter)" target="_blank">
                            <i class="bi bi-twitter-x"></i> Twitter
                        </a>
                    </li>
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://www.dotkernel.com/blog/" class="support__link" title="Blog" target="_blank">
                            <i class="bi bi-file-post"></i> Blog
                        </a>
                    </li>
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://www.dotkernel.com/feed/" class="support__link" title="Blog feed" target="_blank">
                            <i class="bi bi-rss-fill"></i> Feed
                        </a>
                    </li>
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://github.com/orgs/dotkernel/discussions" class="support__link" title="Blog feed" target="_blank">
                            <i class="bi bi-chat-left-text"></i> Discussions
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <hr class="mt-5" />

        <div class="footer_copy">
            &#169; Copyright Dotkernel <span id="current-year"></span>. All rights reserved.
        </div>
    </div>
</footer>

        <script>
            let base_url = '../..',
                project  = "tutorial-101",
                siteName = 'Dotkernel 101';

                document.addEventListener("DOMContentLoaded", function() {
                    document.querySelectorAll('.subnavigation__link').forEach(function(link) {
                        if (link.getAttribute('href') === './') {
                            link.parentNode.parentNode.classList.add('show');
                        }
                    });
                });
        </script>
<!--        -->
<!--        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in Dotkernel 101" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>-->
    </body>
</html>
